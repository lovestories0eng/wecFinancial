!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";var n=e.Pos,t=new RegExp("<(/?)([A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");function i(e,n,t,i){this.line=n,this.ch=t,this.cm=e,this.text=e.getLine(n),this.min=i?i.from:e.firstLine(),this.max=i?i.to-1:e.lastLine()}function r(e,t){var i=e.cm.getTokenTypeAt(n(e.line,t));return i&&/\btag\b/.test(i)}function u(e){if(!(e.line>=e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function f(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function o(e){for(;;){var n=e.text.indexOf(">",e.ch);if(-1==n){if(u(e))continue;return}if(r(e,n+1)){var t=e.text.lastIndexOf("/",n),i=t>-1&&!/\S/.test(e.text.slice(t+1,n));return e.ch=n+1,i?"selfClose":"regular"}e.ch=n+1}}function l(e){for(;;){var n=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==n){if(f(e))continue;return}if(r(e,n+1)){t.lastIndex=n,e.ch=n;var i=t.exec(e.text);if(i&&i.index==n)return i}else e.ch=n}}function c(e){for(;;){t.lastIndex=e.ch;var n=t.exec(e.text);if(!n){if(u(e))continue;return}if(r(e,n.index+1))return e.ch=n.index+n[0].length,n;e.ch=n.index+1}}function a(e){for(;;){var n=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==n){if(f(e))continue;return}if(r(e,n+1)){var t=e.text.lastIndexOf("/",n),i=t>-1&&!/\S/.test(e.text.slice(t+1,n));return e.ch=n+1,i?"selfClose":"regular"}e.ch=n}}function s(e,t){for(var i=[];;){var r,u=c(e),f=e.line,l=e.ch-(u?u[0].length:0);if(!u||!(r=o(e)))return;if("selfClose"!=r)if(u[1]){for(var a=i.length-1;a>=0;--a)if(i[a]==u[2]){i.length=a;break}if(a<0&&(!t||t==u[2]))return{tag:u[2],from:n(f,l),to:n(e.line,e.ch)}}else i.push(u[2])}}function h(e,t){for(var i=[];;){var r=a(e);if(!r)return;if("selfClose"!=r){var u=e.line,f=e.ch,o=l(e);if(!o)return;if(o[1])i.push(o[2]);else{for(var c=i.length-1;c>=0;--c)if(i[c]==o[2]){i.length=c;break}if(c<0&&(!t||t==o[2]))return{tag:o[2],from:n(e.line,e.ch),to:n(u,f)}}}else l(e)}}e.registerHelper("fold","xml",(function(e,t){for(var r=new i(e,t.line,0);;){var u,f=c(r);if(!f||r.line!=t.line||!(u=o(r)))return;if(!f[1]&&"selfClose"!=u){t=n(r.line,r.ch);var l=s(r,f[2]);return l&&{from:t,to:l.from}}}})),e.findMatchingTag=function(e,t,r){var u=new i(e,t.line,t.ch,r);if(-1!=u.text.indexOf(">")||-1!=u.text.indexOf("<")){var f=o(u),c=f&&n(u.line,u.ch),a=f&&l(u);if(f&&a&&(x=t,!(((F=u).line-x.line||F.ch-x.ch)>0))){var F,x,g={from:n(u.line,u.ch),to:c,tag:a[2]};return"selfClose"==f?{open:g,close:null,at:"open"}:a[1]?{open:h(u,a[2]),close:g,at:"close"}:{open:g,close:s(u=new i(e,c.line,c.ch,r),a[2]),at:"open"}}}},e.findEnclosingTag=function(e,n,t){for(var r=new i(e,n.line,n.ch,t);;){var u=h(r);if(!u)break;var f=s(new i(e,n.line,n.ch,t),u.tag);if(f)return{open:u,close:f}}},e.scanForClosingTag=function(e,n,t,r){return s(new i(e,n.line,n.ch,r?{from:0,to:r}:null),t)}}));